{% extends "base.html" %}

{% block content %}

  <h1 style="text-align: center">Task - {{ task.name }}</h1>
  <br>
  <div class="card" style="margin: 15px; padding: 20px; margin-bottom: 30px; background-color: ghostwhite">
    <div class="container mt-5 auction-list-container">
      <div class="row auction-container">
        <div class="col-md-3">
          {#            <img src="/static/img/no-photo-task.jpg" alt="Фото таска" class="img-thumbnail auction-photo">#}
          <div id="carouselExampleFade" class="carousel slide carousel-fade" data-ride="carousel">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <img class="img-fluid d-block w-100"
                     src="https://appsrv1-147a1.kxcdn.com/gradient/images/slider/img-slide-1.jpg" alt="First slide">
              </div>
              <div class="carousel-item">
                <img class="img-fluid d-block w-100"
                     src="https://appsrv1-147a1.kxcdn.com/gradient/images/slider/img-slide-2.jpg" alt="Second slide">
              </div>
              <div class="carousel-item">
                <img class="img-fluid d-block w-100"
                     src="https://appsrv1-147a1.kxcdn.com/gradient/images/slider/img-slide-3.jpg" alt="Third slide">
              </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleFade" role="button" data-slide="prev"><span
            class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only"></span></a>
            <a class="carousel-control-next" href="#carouselExampleFade" role="button" data-slide="next"><span
            class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only"></span></a>
          </div>
        </div>
        <div class="col-md-9">
          <h5 style="text-align: right">
            Дедлайн: {{ task.deadline.date.day }}-{{ task.deadline.date.month }}-{{ task.deadline.date.year }} {{ task.deadline.hour }}:{{ task.deadline.minute }}</h5>
          <div class="row">
            <div class="col">
              <p class="overflow-auto">{{ task.description }}</p>
            </div>
            <div class="col-4 d-flex flex-column justify-content-end align-items-end pb-2"><a href="{% url 'task_manager:task-update' task.id %}">
              {% if request.user.id == task.creator.id %}
              <button type="button" class="btn  btn-outline-dark">Refactor</button>
              {% endif %}

              {% if request.user in task.assignees.all %}
              <button type="button" class="btn  btn-outline-success">Done</button>
              {% endif %}
            </a>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="card" style="margin: 15px; background-color: ghostwhite">
    <div class="card-header">
      <h3 style="text-align: center">Collaborators:</h3>

    </div>
    <div class="card-body table-border-style">
      <div class="table-responsive">
        <table class="table table-dark">
          <thead>
          <tr>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Username</th>
            <th>Position</th>
          </tr>
          </thead>
          <tbody>
          {% for participant in task.assignees.all %}

            <tr>
              <td>{{ participant.first_name }}</td>
              <td>{{ participant.last_name }}</td>
              <td>
                <a href="{% url 'profile' participant.id %}">{{ participant.username }}</a>
              </td>
              <td>{{ participant.position }}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="card" style="padding: 15px; margin: 15px;background-color: ghostwhite">

    <h3 style="text-align: center">Discussion</h3>
    <hr>

    <br>
    <div >
      {% if task.comments.all %}
        {% for comment in task.comments.all %}
          <p>Comment from <strong><a style="text-decoration: none; font-size: 22px"
                                     href="{% url 'profile' comment.user.id %}">{{ comment.user.username }}</a>
            :</strong></p>
          <p class="content-font" style="font-size: 18px">{{ comment.content }}</p>
          <hr>
        {% endfor %}
      {% else %}
        <p class="content-font" style="font-size: 22px; text-align: center; margin-bottom: 0">There are no comments</p>

      {% endif %}
    </div>
    <br>
    {% if request.user in task.assignees.all %}
      <form action="{% url 'task_manager:task-create-comment' task.id %}" method="post">
        <div><input type="text" name="content" placeholder="Enter comment" class="datetimeinput form-control"
                    id="content"></div>
        <br>
        <button class="btn btn-primary" type="submit"
        >Create a comment
        </button>
        {% csrf_token %}
      </form>
    {% endif %}
  </div>

  <script src="https://appsrv1-147a1.kxcdn.com/gradient/js/vendor-all.min.js"></script>
  <script src="https://appsrv1-147a1.kxcdn.com/gradient/js/plugins/bootstrap.min.js"></script>
  <script src="https://appsrv1-147a1.kxcdn.com/gradient/js/pcoded.min.js"></script>
{% endblock %}
